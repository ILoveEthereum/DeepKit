<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Conversational Agent Test Client</title>\n    <script src=\"https://unpkg.com/livekit-client@latest/dist/livekit-client.umd.js\"></script>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n            color: white;\n        }\n        .container {\n            background: rgba(255, 255, 255, 0.1);\n            backdrop-filter: blur(10px);\n            border-radius: 20px;\n            padding: 30px;\n            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);\n        }\n        h1 {\n            text-align: center;\n            margin-bottom: 30px;\n            font-size: 2.5em;\n            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);\n        }\n        .form-group {\n            margin-bottom: 20px;\n        }\n        label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: 600;\n            font-size: 1.1em;\n        }\n        input {\n            width: 100%;\n            padding: 12px;\n            border: none;\n            border-radius: 10px;\n            font-size: 16px;\n            background: rgba(255, 255, 255, 0.9);\n            color: #333;\n            box-sizing: border-box;\n        }\n        input:focus {\n            outline: none;\n            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);\n        }\n        .buttons {\n            display: flex;\n            gap: 15px;\n            flex-wrap: wrap;\n            justify-content: center;\n            margin: 30px 0;\n        }\n        button {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 10px;\n            font-size: 16px;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            min-width: 120px;\n        }\n        .primary {\n            background: #4CAF50;\n            color: white;\n        }\n        .primary:hover {\n            background: #45a049;\n            transform: translateY(-2px);\n        }\n        .primary:disabled {\n            background: #cccccc;\n            cursor: not-allowed;\n            transform: none;\n        }\n        .danger {\n            background: #f44336;\n            color: white;\n        }\n        .danger:hover {\n            background: #da190b;\n            transform: translateY(-2px);\n        }\n        .info {\n            background: #2196F3;\n            color: white;\n        }\n        .info:hover {\n            background: #1976D2;\n            transform: translateY(-2px);\n        }\n        .status {\n            padding: 15px;\n            border-radius: 10px;\n            margin: 20px 0;\n            font-weight: 600;\n            text-align: center;\n        }\n        .status.disconnected {\n            background: rgba(244, 67, 54, 0.2);\n            border: 2px solid #f44336;\n        }\n        .status.connected {\n            background: rgba(76, 175, 80, 0.2);\n            border: 2px solid #4CAF50;\n        }\n        .status.connecting {\n            background: rgba(255, 193, 7, 0.2);\n            border: 2px solid #FFC107;\n            color: #333;\n        }\n        .instructions {\n            background: rgba(33, 150, 243, 0.2);\n            border: 2px solid #2196F3;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 20px 0;\n        }\n        .instructions h3 {\n            margin-top: 0;\n            color: #E3F2FD;\n        }\n        .instructions ul {\n            margin: 10px 0;\n            padding-left: 20px;\n        }\n        .instructions li {\n            margin: 8px 0;\n            line-height: 1.4;\n        }\n        .audio-controls {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            margin: 20px 0;\n        }\n        audio {\n            flex: 1;\n            border-radius: 10px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>ðŸ¤– Conversational Agent</h1>\n        \n        <div class=\"form-group\">\n            <label for=\"serverUrl\">LiveKit Server URL:</label>\n            <input type=\"text\" id=\"serverUrl\" placeholder=\"wss://your-server.livekit.cloud\" />\n        </div>\n        \n        <div class=\"form-group\">\n            <label for=\"token\">Access Token:</label>\n            <input type=\"text\" id=\"token\" placeholder=\"Your LiveKit access token\" />\n        </div>\n        \n        <div class=\"form-group\">\n            <label for=\"roomName\">Room Name:</label>\n            <input type=\"text\" id=\"roomName\" placeholder=\"test-room\" value=\"test-room\" />\n        </div>\n        \n        <div class=\"buttons\">\n            <button id=\"connectBtn\" class=\"primary\">Connect to Agent</button>\n            <button id=\"disconnectBtn\" class=\"danger\" disabled>Disconnect</button>\n            <button id=\"muteBtn\" class=\"info\" disabled>Mute Mic</button>\n        </div>\n        \n        <div id=\"status\" class=\"status disconnected\">Not Connected</div>\n        \n        <div class=\"instructions\">\n            <h3>ðŸŽ¯ How to Use:</h3>\n            <ul>\n                <li><strong>Setup:</strong> Enter your LiveKit server URL and access token above</li>\n                <li><strong>Connect:</strong> Click \"Connect to Agent\" to join the room</li>\n                <li><strong>Talk:</strong> Once connected, start speaking! The agent will respond with voice</li>\n                <li><strong>Features:</strong> Try asking for:\n                    <ul>\n                        <li>\"What time is it?\" - Get current date and time</li>\n                        <li>\"What's the weather in [city]?\" - Get weather information</li>\n                        <li>\"Calculate 15 * 7\" - Perform math calculations</li>\n                        <li>Any general conversation!</li>\n                    </ul>\n                </li>\n            </ul>\n        </div>\n        \n        <div class=\"audio-controls\">\n            <audio id=\"audioElement\" controls autoplay style=\"width: 100%;\"></audio>\n        </div>\n    </div>\n\n    <script>\n        const { Room, LocalAudioTrack, RemoteTrack } = LiveKitClient;\n        \n        let room = null;\n        let localAudioTrack = null;\n        let isMuted = false;\n        \n        const connectBtn = document.getElementById('connectBtn');\n        const disconnectBtn = document.getElementById('disconnectBtn');\n        const muteBtn = document.getElementById('muteBtn');\n        const status = document.getElementById('status');\n        const audioElement = document.getElementById('audioElement');\n        \n        function updateStatus(message, className) {\n            status.textContent = message;\n            status.className = `status ${className}`;\n        }\n        \n        async function connect() {\n            const serverUrl = document.getElementById('serverUrl').value;\n            const token = document.getElementById('token').value;\n            const roomName = document.getElementById('roomName').value;\n            \n            if (!serverUrl || !token || !roomName) {\n                alert('Please fill in all fields');\n                return;\n            }\n            \n            try {\n                updateStatus('Connecting...', 'connecting');\n                connectBtn.disabled = true;\n                \n                room = new Room();\n                \n                // Handle room events\n                room.on('connected', () => {\n                    updateStatus('Connected to Agent! Start speaking...', 'connected');\n                    disconnectBtn.disabled = false;\n                    muteBtn.disabled = false;\n                });\n                \n                room.on('disconnected', () => {\n                    updateStatus('Disconnected', 'disconnected');\n                    connectBtn.disabled = false;\n                    disconnectBtn.disabled = true;\n                    muteBtn.disabled = true;\n                    muteBtn.textContent = 'Mute Mic';\n                    isMuted = false;\n                });\n                \n                room.on('participantConnected', (participant) => {\n                    console.log('Participant connected:', participant.identity);\n                    if (participant.identity.includes('agent')) {\n                        updateStatus('ðŸ¤– AI Agent joined! Ready to chat...', 'connected');\n                    }\n                });\n                \n                room.on('trackSubscribed', (track, publication, participant) => {\n                    if (track.kind === 'audio' && participant.identity.includes('agent')) {\n                        console.log('Subscribed to agent audio track');\n                        const audioElement = track.attach();\n                        audioElement.autoplay = true;\n                        document.body.appendChild(audioElement);\n                    }\n                });\n                \n                // Get microphone access\n                localAudioTrack = await LocalAudioTrack.createMicrophoneTrack();\n                \n                // Connect to room\n                await room.connect(serverUrl, token);\n                \n                // Publish microphone track\n                await room.localParticipant.publishTrack(localAudioTrack, {\n                    name: 'microphone',\n                });\n                \n                console.log('Successfully connected to room:', roomName);\n                \n            } catch (error) {\n                console.error('Connection failed:', error);\n                updateStatus(`Connection failed: ${error.message}`, 'disconnected');\n                connectBtn.disabled = false;\n            }\n        }\n        \n        async function disconnect() {\n            if (room) {\n                await room.disconnect();\n                room = null;\n            }\n            if (localAudioTrack) {\n                localAudioTrack.stop();\n                localAudioTrack = null;\n            }\n        }\n        \n        async function toggleMute() {\n            if (!localAudioTrack) return;\n            \n            if (isMuted) {\n                await localAudioTrack.unmute();\n                muteBtn.textContent = 'Mute Mic';\n                muteBtn.className = 'info';\n                isMuted = false;\n            } else {\n                await localAudioTrack.mute();\n                muteBtn.textContent = 'Unmute Mic';\n                muteBtn.className = 'primary';\n                isMuted = true;\n            }\n        }\n        \n        // Event listeners\n        connectBtn.addEventListener('click', connect);\n        disconnectBtn.addEventListener('click', disconnect);\n        muteBtn.addEventListener('click', toggleMute);\n        \n        // Handle page unload\n        window.addEventListener('beforeunload', () => {\n            if (room) {\n                room.disconnect();\n            }\n        });\n    </script>\n</body>\n</html>\n
